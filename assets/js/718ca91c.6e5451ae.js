"use strict";(self.webpackChunkfleet_docs=self.webpackChunkfleet_docs||[]).push([[2194],{5680:(e,t,r)=>{r.d(t,{xA:()=>u,yg:()=>y});var n=r(6540);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var l=n.createContext({}),c=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},u=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(r),g=o,y=p["".concat(l,".").concat(g)]||p[g]||d[g]||i;return r?n.createElement(y,a(a({ref:t},u),{},{components:r})):n.createElement(y,a({ref:t},u))}));function y(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=r.length,a=new Array(i);a[0]=g;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:o,a[1]=s;for(var c=2;c<i;c++)a[c]=r[c];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}g.displayName="MDXCreateElement"},2427:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var n=r(8168),o=(r(6540),r(5680));const i={},a="OCI Storage",s={unversionedId:"oci-storage",id:"oci-storage",title:"OCI Storage",description:"Summary",source:"@site/docs/oci-storage.md",sourceDirName:".",slug:"/oci-storage",permalink:"/oci-storage",draft:!1,editUrl:"https://github.com/rancher/fleet-docs/edit/main/docs/oci-storage.md",tags:[],version:"current",lastUpdatedAt:1727422857,formattedLastUpdatedAt:"Sep 27, 2024",frontMatter:{},sidebar:"docs",previous:{title:"How to enable experimental features",permalink:"/enableexperimental"}},l={},c=[{value:"Summary",id:"summary",level:2},{value:"Configuring the OCI registry",id:"configuring-the-oci-registry",level:2}],u={toc:c},p="wrapper";function d(e){let{components:t,...r}=e;return(0,o.yg)(p,(0,n.A)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,o.yg)("h1",{id:"oci-storage"},"OCI Storage"),(0,o.yg)("h2",{id:"summary"},"Summary"),(0,o.yg)("p",null,"Fleet stores by default the bundle resources in etcd twice. This is done via the k8s API and there is a size limit, depending on the etcd configuration."),(0,o.yg)("p",null,"This feature will allow users to choose an OCI registry as storage for bundle resources. The bundle resource will have an empty resource list and a reference to the OCI repository server. The bundledeployment will not point to a content resource, but to an OCI repository server instead."),(0,o.yg)("p",null,"When using this feature the bundle resources are stored once, in the configured OCI registry, and Fleet won't be tied to possible ",(0,o.yg)("inlineCode",{parentName:"p"},"etcd")," size limitations."),(0,o.yg)("p",null,"This may me interesting for users who need to store big ",(0,o.yg)("inlineCode",{parentName:"p"},"Bundles"),", and could also be seen as the first step for an ",(0,o.yg)("inlineCode",{parentName:"p"},"OCIOps")," feature in the future."),(0,o.yg)("p",null,"Once the OCI registry is enabled, Fleet will use it as the source for storing ",(0,o.yg)("inlineCode",{parentName:"p"},"Bundle")," resources.\nWhen Fleet can't access the OCI registry, it won't fall back to default ",(0,o.yg)("inlineCode",{parentName:"p"},"etcd")," storage. Instead, it will log errors so they can be fixed."),(0,o.yg)("h2",{id:"configuring-the-oci-registry"},"Configuring the OCI registry"),(0,o.yg)("p",null,"OCI registry values should be configured as an extra section in the ",(0,o.yg)("inlineCode",{parentName:"p"},"GitRepo")," yaml."),(0,o.yg)("p",null,"There are the fields involved:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre"},'// when ociRegistry is defined Fleet will use oci registry as storage\nociRegistry:\n    // url is the OCI registry url.\n    url: "docker.io/your-user-here"\n    // secret name where the credentials for the OCI registry are.\n    // expects a generic secret with username and password keys set.\n    authSecretName: oci-secret\n    // basicHTTP allows Fleet to uses basic http connections to communicate\n    // with the registry (defaults to false)\n    basicHTTP: false\n    // insecureSkipTLS allows connections to the OCI registry\n    // without certs (defaults to false)\n    insecureSkipTLS: false\n')))}d.isMDXComponent=!0}}]);